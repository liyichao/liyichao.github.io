---
layout: post
title: "监控系统与资产管理系统、服务发现系统整合"
category:
tags: []
---
{% include JB/setup %}


Zabbix 所有数据都可以通过 API 获得和设定，因此监控系统既可以向外提供数据，也可以方便的利用外界提供的数据。

### 监控系统与资产管理系统的整合

整合的想法成城提过几次，近几天都在做 tracing 系统，没细想监控系统的事情，今天紧急改 status 和 beanstalk 主机的报警的时候想了想这个问题，想到以下几点：

* Zabbix 里，主机具有 [Host inventory 属性](https://www.zabbix.com/documentation/2.2/manual/config/hosts/inventory)，可以自己填，也可以根据一些信息自动生成，即使不用，也可以参考一下里面到底有什么信息（@吴昊，具体的域要先登录，然后点 Create Host）。我觉得对监控来说，重要的有以下信息：

	* 主机所属的 Group
	* 主机的负责人
	* 主机上运行的程序，即主机的用途，功能

这些都是属于资产管理的概念，不应该在 Zabbix 里设置，所以我希望资产管理系统能提供获得这些信息的 API。监控系统还需要一个用户列表，用户和主机的负责人是同一个 Model，其属性有：姓名，电话，邮箱。不知道我们现在用户管理是用的什么，创建了一个知乎邮箱， Ph 和 gitlab 是怎么自动有这个用户的。

### 监控系统与服务管理系统的整合

这个是江泽的想法。

有一些基本的监控项（如服务是否挂了，服务的响应时间），适用于所有服务，不需要开发者来定义，或者开发者只需要定义阈值，根据阈值，负责人，自动生成 Zabbix 的 Item，Trigger，Action，从而实现报警。

服务一注册，报警自动生成，服务一退下来，自动清除报警。当时和江泽聊的时候确定的初步实现思路是服务编写者提供编写一个简单的配置文件，定义阈值，而监控的项目，是标准，不需要开发者定义。而报警的生成和清除，要和服务发现服务结合起来做。